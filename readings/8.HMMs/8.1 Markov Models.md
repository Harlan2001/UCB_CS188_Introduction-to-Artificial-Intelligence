### 8.1 马尔可夫模型（Markov Models）

在之前的笔记中，我们讨论了贝叶斯网络（Bayes’ nets），它是用于紧凑表示随机变量关系的优秀结构。现在，我们将介绍一个紧密相关的结构——**马尔可夫模型（Markov model）**。在本课程中，可以将其视作“链状的无限长度贝叶斯网络”。本节示例以天气的日常波动为例，建立一个时间依赖的模型：每一天都有一个独立的随机变量 \(W_i\) 表示第 \(i\) 天的天气。

![](../../image/8.HMMs/weather-markov.png)

---

#### 马尔可夫模型的核心信息

为了跟踪随时间变化的随机变量（天气），我们需要：

1. **初始分布** \(P(W_0)\)：表示时间 \(t=0\) 时天气的概率。
2. **转移模型** \(P(W_{i+1} \mid W_i)\)：描述从状态 \(W_i\) 转移到 \(W_{i+1}\) 的概率。

转移模型意味着 \(W_{i+1}\) 只条件依赖于 \(W_i\)，即满足**马尔可夫性质（Markov property）**或“无记忆性”，与其他时刻独立。

**链式联合分布**：

\[
\begin{aligned}
P(W_0, W_1, W_2) &= P(W_0) P(W_1 \mid W_0) P(W_2 \mid W_1, W_0) \\
&= P(W_0) P(W_1 \mid W_0) P(W_2 \mid W_1) \quad (\text{马尔可夫性质})
\end{aligned}
\]

一般情况下，对于前 \(n+1\) 个变量：

\[
P(W_0, W_1, \dots, W_n) = P(W_0) \prod_{i=0}^{n-1} P(W_{i+1} \mid W_i)
\]

通常假设**转移模型是平稳的（stationary）**，即对所有 \(i\)：

\[
P(W_{i+1} \mid W_i) \text{ 相同}
\]

因此只需两个表：初始分布 \(P(W_0)\) 与转移模型 \(P(W_{i+1} \mid W_i)\)。

---

### 8.1.1 Mini-Forward 算法

为了计算某一天 \(t\) 的天气分布，直接求联合再边缘化非常低效（如果每个变量有 \(d\) 种取值，\(j\) 个变量，联合分布大小为 \(O(d^j)\)）。更高效的方法是**mini-forward 算法**。

利用边缘化性质：

\[
P(W_{i+1}) = \sum_{w_i} P(W_{i+1}, w_i) = \sum_{w_i} P(W_{i+1} \mid w_i) P(w_i)
\]

直观理解：通过转移模型 \(P(W_{i+1} \mid W_i)\) 将时间步 \(i\) 的分布推进到时间步 \(i+1\)。

**示例**：

初始分布：

| W₀  | P(W₀) |
|-----|-------|
| sun | 0.8   |
| rain| 0.2   |

转移模型：

| W_i+1 | W_i  | P(W_{i+1} | W_i) |
|--------|-----|----------------|
| sun    | sun | 0.6            |
| rain   | sun | 0.4            |
| sun    | rain| 0.1            |
| rain   | rain| 0.9            |

计算 \(P(W_1)\)：

\[
\begin{aligned}
P(W_1 = sun) &= 0.6 \cdot 0.8 + 0.1 \cdot 0.2 = 0.5 \\
P(W_1 = rain)&= 0.4 \cdot 0.8 + 0.9 \cdot 0.2 = 0.5
\end{aligned}
\]

结果分布：

| W₁  | P(W₁) |
|-----|-------|
| sun | 0.5   |
| rain| 0.5   |

概率从 80% 的晴天下降到 50%，反映转移模型偏向雨天。

---

### 8.1.2 平稳分布（Stationary Distribution）

**平稳分布**是随着时间推移保持不变的分布：

\[
P(W_t) = P(W_{t+1})
\]

利用 mini-forward 公式求解平稳分布：

\[
\begin{aligned}
P(W_t = sun) &= 0.6 \cdot P(W_t = sun) + 0.1 \cdot P(W_t = rain) \\
P(W_t = rain)&= 0.4 \cdot P(W_t = sun) + 0.9 \cdot P(W_t = rain)
\end{aligned}
\]

设 \(x = P(W_t = sun)\)，\(y = P(W_t = rain)\)，并且 \(x + y = 1\)：

\[
0.6x + 0.1(1-x) = x \quad \Rightarrow \quad x = 0.2, \ y = 0.8
\]

平稳分布结果：

| W    | P(W) |
|------|------|
| sun  | 0.2  |
| rain | 0.8  |

结论：随着时间趋于无穷，雨天概率收敛到 80%，晴天概率收敛到 20%，由转移模型偏向雨天所决定。
