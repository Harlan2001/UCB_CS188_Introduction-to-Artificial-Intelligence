## 2.2 求解约束满足问题（Solving Constraint Satisfaction Problems）

约束满足问题通常使用一种称为**回溯搜索（backtracking search）** 的搜索算法来求解。回溯搜索是一种专门针对约束满足问题、在**深度优先搜索（depth-first search）** 基础上的优化，其改进主要来源于以下两个核心原则：

1. **固定变量的赋值顺序，并按照该顺序为变量选择取值。**  
   由于赋值操作是**可交换的**（例如，先赋值 $WA = Red$、再赋值 $NT = Green$，与先赋值 $NT = Green$、再赋值 $WA = Red$ 是等价的），因此这样做是合理的。

2. **在为某个变量选择取值时，只选择那些不会与任何已赋值变量发生冲突的取值。**  
   如果不存在这样的取值，则进行回溯，返回到前一个变量，并尝试为其更换取值。

下面给出了**递归回溯搜索**的伪代码：

![](../../image/2.CSPs/backtracking-search-pseudo.png)

*Backtracking search pseudocode*

为了更直观地理解这一过程，考虑在地图着色问题中，**深度优先搜索**和**回溯搜索**对应的部分搜索树的可视化对比：

![](../../image/2.CSPs/dfs-vs-backtracking.png)

*DFS vs Backtracking search*

可以注意到，深度优先搜索会“后悔地”先把所有区域都涂成红色，直到最后才意识到需要进行修改；而即便如此，它在朝向正确解的方向上前进得也并不理想。相比之下，回溯搜索只在某个取值**不违反任何约束**的情况下，才会将该取值赋给变量，从而显著减少了回溯的次数。尽管回溯搜索相比于暴力枚举式的深度优先搜索已经有了巨大改进，但我们仍然可以通过**过滤（filtering）**、**变量/取值顺序的选择（variable/value ordering）** 以及**结构性利用（structural exploitation）** 等进一步的优化手段，获得更高的求解速度。
