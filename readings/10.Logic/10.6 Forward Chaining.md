# 10.6 正向链（Forward Chaining）

**正向链算法**会遍历每条前提（左侧）已知为真的蕴含语句，将结论（右侧）添加到已知事实列表中。

## 10.6.1 正向链示例

假设我们有以下知识库：
\[
A → B  
A → C  
B ∧ C → D  
D ∧ E → Q  
A ∧ D → Q  
A
\]


我们希望使用正向链来确定 \(Q\) 的真值。

### 初始化算法

1. 初始化一个数字列表 **count**。列表中的第 \(i\) 个数字表示第 \(i\) 个子句的前提中有多少个符号。例如，第 3 个子句 \(B ∧ C → D\) 的前提有 2 个符号（B 和 C），所以列表中的第 3 个数字为 2。注意，第 6 个子句 \(A\) 的前提有 0 个符号，因为它等价于 True → A。

2. 初始化 **inferred**，它将每个符号映射为 True/False，表示哪些符号已经被证明为真。最初，所有符号为 False，因为尚未证明任何符号为真。

3. 初始化符号列表 **agenda**，它包含可以被证明为真的符号，但尚未传播其影响。例如，如果 D 在 agenda 中，表示我们准备证明 D 为真，但还需要检查它如何影响其他子句。初始时，agenda 仅包含我们直接知道为真的符号，这里只有 A（即前提为 0 个符号的子句）。

#### 初始状态

\[
\begin{aligned}
\text{count} &= [1, 1, 2, 2, 2, 0] \\
\text{inferred} &= \{ A: F, B: F, C: F, D: F, E: F, Q: F \} \\
\text{agenda} &= [A]
\end{aligned}
\]


### 迭代 0

- 从 **agenda** 弹出 A（不是我们要分析的 Q，所以算法未结束）。
- 根据 **inferred**，A 目前为 False，但由于刚弹出 A，可以将其设为 True。
- 传播 A 为真的结果：对于包含 A 的子句（子句 1, 2, 5），将 count 减 1。
- 检查是否有子句 count 为 0：子句 1 和 2，表示前提已满足，可以推断结论 B 和 C，并加入 agenda。

\[
\begin{aligned}
\text{count} &= [0, 0, 2, 2, 1, 0] \\
\text{inferred} &= \{ A: T, B: F, C: F, D: F, E: F, Q: F \} \\
\text{agenda} &= [B, C]
\end{aligned}
\]


### 迭代 1

- 弹出 B（不是 Q，算法未结束）。
- 将 B 设为 True。
- 传播 B 为真的结果：只有子句 3 包含 B，将其 count 减 1。
- 检查 count 为 0 的子句：没有新子句满足前提，无法推导新结论，agenda 只剩 C。

\[
\begin{aligned}
\text{count} &= [0, 0, 1, 2, 1, 0] \\
\text{inferred} &= \{ A: T, B: T, C: F, D: F, E: F, Q: F \} \\
\text{agenda} &= [C]
\end{aligned}
\]

### 迭代 2

- 弹出 C（不是 Q，算法未结束）。
- 将 C 设为 True。
- 传播 C 为真的结果：子句 3 包含 C，将 count 减 1。
- 子句 3 的 count 变为 0，结论 D 可以推断，加入 agenda。

\[
\begin{aligned}
\text{count} &= [0, 0, 0, 2, 1, 0] \\
\text{inferred} &= \{ A: T, B: T, C: T, D: F, E: F, Q: F \} \\
\text{agenda} &= [D]
\end{aligned}
\]


### 迭代 3

- 弹出 D（不是 Q，算法未结束）。
- 将 D 设为 True。
- 传播 D 为真的结果：子句 4 和 5 包含 D，count 分别减 1。
- 子句 5 的 count 变为 0，结论 Q 可以推断，加入 agenda。

\[
\begin{aligned}
\text{count} &= [0, 0, 0, 1, 0, 0] \\
\text{inferred} &= \{ A: T, B: T, C: T, D: T, E: F, Q: F \} \\
\text{agenda} &= [Q]
\end{aligned}
\]



### 最后一步

- 弹出 Q（正是我们要分析的符号），说明 Q 已被证明为真。
- 算法结束，我们可以得出结论：

