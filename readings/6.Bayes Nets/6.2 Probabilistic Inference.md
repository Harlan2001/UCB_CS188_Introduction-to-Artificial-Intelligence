# 6.2 概率推理

在人工智能中，我们经常希望建模各种不确定事件之间的关系。如果天气预报说有 40% 的降雨概率，我应该带伞吗？如果我买的冰淇淋球越多，就越可能全部掉掉，我应该买多少球？如果在我去 **Oracle Arena** 看 **勇士队** 比赛的路上，高速公路 15 分钟前发生了事故，我应该现在出发还是 30 分钟后出发？所有这些问题（以及更多问题）都可以通过概率推理来回答。

在本课程之前的章节中，我们将世界建模为存在于一个特定状态中，该状态总是已知的。在接下来的几周中，我们将使用一个新模型，其中世界的每个可能状态都有其概率。例如，我们可能建立一个天气模型，其中状态由季节、温度和天气组成。我们的模型可能表示：

\[
P(\text{winter}, 35^\circ, \text{cloudy}) = 0.023
\]

这个数字表示特定结果的概率：即冬天、温度 35° 并且多云的概率。

更准确地说，我们的模型是一个联合分布，即一个概率表，捕捉每个可能结果的可能性，也称为变量的赋值。例如，考虑下表：

| Season | Temperature | Weather | Probability |
|--------|------------|---------|------------|
| summer | hot        | sun     | 0.30       |
| summer | hot        | rain    | 0.05       |
| summer | cold       | sun     | 0.10       |
| summer | cold       | rain    | 0.05       |
| winter | hot        | sun     | 0.10       |
| winter | hot        | rain    | 0.05       |
| winter | cold       | sun     | 0.15       |
| winter | cold       | rain    | 0.20       |

该模型允许我们回答可能感兴趣的问题，例如：

1. 阳光的概率是多少？

\[
P(W = \text{sun})
\]

2. 已知是冬天的情况下，天气的概率分布是多少？

\[
P(W \mid S = \text{winter})
\]

3. 已知天气是雨天且寒冷的情况下，冬天的概率是多少？

\[
P(S = \text{winter} \mid T = \text{cold}, W = \text{rain})
\]

4. 已知天气寒冷的情况下，天气和季节的概率分布是多少？

\[
P(S, W \mid T = \text{cold})
\]

---

## 枚举推理（Inference By Enumeration）

给定联合 PDF，我们可以使用一种简单直观的程序——枚举推理（Inference By Enumeration, IBE）轻松计算任何所需的概率分布：

\[
P(Q_1, \dots, Q_m \mid e_1, \dots, e_n)
\]

为此，我们定义三类变量：

1. **查询变量（Query variables）** \(Q_i\)：未知变量，出现在所需概率分布条件符号 \( |\) 的左侧。
2. **证据变量（Evidence variables）** \(e_i\)：已观察变量，其值已知，出现在所需概率分布条件符号 \( |\) 的右侧。
3. **隐藏变量（Hidden variables）**：存在于整体联合分布中，但不在所需分布中出现的变量。

在枚举推理中，我们遵循以下算法：

1. 收集与已观察的证据变量一致的所有行。
2. 对所有隐藏变量进行求和（边缘化）。
3. 归一化表格，使其成为概率分布（即所有值之和为 1）。

例如，如果我们想使用上述联合分布计算：

\[
P(W \mid S = \text{winter})
\]

我们会选择所有 \(S = \text{winter}\) 的四行，然后对 \(T\) 求和并归一化。得到如下概率表：

| W    | S      | 未归一化和 | 概率       |
|------|--------|------------|------------|
| sun  | winter | 0.10+0.15=0.25 | 0.25 / (0.25+0.25) = 0.5 |
| rain | winter | 0.05+0.20=0.25 | 0.25 / (0.25+0.25) = 0.5 |

因此：

\[
P(W = \text{sun} \mid S = \text{winter}) = 0.5, \quad P(W = \text{rain} \mid S = \text{winter}) = 0.5
\]

我们得出冬天有 50% 的概率是晴天，50% 的概率是雨天。

只要我们有联合 PDF 表，枚举推理（IBE）就可以用于计算任何所需的概率分布，即使是多个查询变量 \(Q_1, \dots, Q_m\)。
