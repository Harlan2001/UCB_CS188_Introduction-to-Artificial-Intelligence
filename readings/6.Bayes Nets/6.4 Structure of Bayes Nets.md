# 6.4 贝叶斯网络的结构

在本课程中，我们将参考两个贝叶斯网络独立性规则，这些规则可以通过观察贝叶斯网络的图结构推断出来：

1. 每个节点在已知其所有父节点的条件下，对图中所有祖先节点（非后代）条件独立。  
   **父节点（Parents）**

![](../../image/6.BayesNets/parents.png)
2. 每个节点在已知其马尔可夫毯（Markov Blanket）的条件下，对所有其他变量条件独立。一个变量的马尔可夫毯包括其父节点、子节点以及子节点的其他父节点。  
![](../../image/6.BayesNets/blanket.png)

   **马尔可夫毯（Markov Blanket）**

使用这些工具，我们可以回到上一节的断言：通过连接贝叶斯网络的 CPT，可以得到所有变量的联合分布。

\[
P(X_1, X_2, \dots, X_n) = \prod_{i=1}^{n} P(X_i \mid \text{parents}(X_i))
\]

贝叶斯网络的联合分布与 CPT 之间的关系之所以成立，是因为图中给出的条件独立关系。下面我们用一个例子证明这一点。

---

回顾之前的示例，我们有 CPT：

\[
P(B), \quad P(E), \quad P(A \mid B,E), \quad P(J \mid A), \quad P(M \mid A)
\]

以及如下图：

![](../../image/6.BayesNets/basic_bayes_nets.png)

**基本贝叶斯网络示例**

对于这个贝叶斯网络，我们希望证明以下关系：

\[
P(B,E,A,J,M) = P(B) P(E) P(A \mid B,E) P(J \mid A) P(M \mid A)
\]

我们也可以用另一种方式展开联合分布：使用链式法则。如果我们按照拓扑顺序（父节点在子节点之前）展开联合分布，得到：

\[
P(B,E,A,J,M) = P(B) P(E \mid B) P(A \mid B,E) P(J \mid B,E,A) P(M \mid B,E,A,J)
\]

注意，在第一个等式中，每个变量都在一个 CPT 中表示：

\[
P(\text{var} \mid \text{Parents(var)})
\]

而在第二个等式中，每个变量都在一个 CPT 中表示：

\[
P(\text{var} \mid \text{Parents(var)}, \text{Ancestors(var)})
\]

我们依赖上面的第一个条件独立关系，即每个节点在已知其所有父节点的条件下，对图中所有祖先节点条件独立¹。

因此，在贝叶斯网络中：

\[
P(\text{var} \mid \text{Parents(var)}, \text{Ancestors(var)}) = P(\text{var} \mid \text{Parents(var)})
\]

所以这两个等式是相等的。贝叶斯网络中的条件独立性允许使用多个较小的条件概率表来表示整个联合概率分布。

在其他文献中，这一假设可能定义为“一个节点在已知其父节点的条件下，对其非后代节点条件独立”。我们总是希望尽量做最小假设并证明所需内容，因此我们将使用祖先假设。  
¹
