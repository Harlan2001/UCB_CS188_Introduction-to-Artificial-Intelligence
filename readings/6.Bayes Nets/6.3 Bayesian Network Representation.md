# 6.3 贝叶斯网络表示

虽然枚举推理可以计算我们希望得到的任何查询的概率，但在计算机内存中表示整个联合分布对于实际问题是不切实际的——如果我们希望表示的每个 \(n\) 个变量可以取 \(d\) 个可能值（其取值域大小为 \(d\)），那么我们的联合分布表将有 \(d^n\) 个条目，随着变量数量呈指数增长，存储起来非常不现实！

贝叶斯网络通过利用条件概率的思想避免了这个问题。概率信息不是存储在一个巨大的表格中，而是分布在多个较小的条件概率表（Conditional Probability Tables, CPT）中，并配合一个有向无环图（DAG）来捕捉变量之间的关系。局部概率表和 DAG 共同编码的信息足以计算我们如果拥有整个大型联合分布本可以计算的任何概率分布。下一节我们将看到具体工作原理。

我们正式定义贝叶斯网络（Bayes Net）由以下部分组成：

1. 一个有向无环图（DAG），每个节点对应一个变量 \(X\)。

2. 每个节点的条件分布 \(P(X \mid A_1, \dots, A_n)\)，其中 \(A_i\) 是 \(X\) 的第 \(i\) 个父节点，存储为条件概率表（CPT）。每个 CPT 有 \(n+2\) 列：一列对应每个父变量 \(A_1, \dots, A_n\) 的取值，一列对应 \(X\) 的取值，一列对应在给定父节点条件下 \(X\) 的条件概率。

贝叶斯网络图的结构编码了不同节点之间的条件独立关系。这些条件独立性使我们可以存储多个小表而不是一个大表。

需要注意的是，贝叶斯网络节点之间的边并不意味着这些节点之间存在具体的因果关系，也不意味着变量一定相互依赖。它仅表示节点之间可能存在某种关系。

---

## 贝叶斯网络示例

考虑一个包含五个二元随机变量的模型：

- \(B\)：入室盗窃发生（Burglary occurs）  
- \(A\)：警报响起（Alarm goes off）  
- \(E\)：地震发生（Earthquake occurs）  
- \(J\)：John 打电话（John calls）  
- \(M\)：Mary 打电话（Mary calls）  

假设如果发生盗窃或地震，警报可能响起；如果 Mary 或 John 听到警报，他们会打电话。我们可以用下图表示这些依赖关系。

**基本贝叶斯网络示例**

![](../../image/6.BayesNets/basic_bayes_nets.png)
在这个贝叶斯网络中，我们会存储以下概率表：

\[
P(B), \quad P(E), \quad P(A \mid B, E), \quad P(J \mid A), \quad P(M \mid A)
\]

给定图中所有 CPT，我们可以使用以下规则计算一个赋值的概率：

\[
P(X_1, X_2, \dots, X_n) = \prod_{i=1}^{n} P(X_i \mid \text{parents}(X_i))
\]

对于上面的警报模型，我们可以计算联合概率如下：

\[
P(-b, -e, +a, +j, -m) = P(-b) \cdot P(-e) \cdot P(+a \mid -b, -e) \cdot P(+j \mid +a) \cdot P(-m \mid +a)
\]

下一节我们将看到这个关系如何成立。

---

作为现实检验，需要理解的是，贝叶斯网络只是一种模型。模型尝试捕捉世界的运行方式，但因为它们总是简化的，所以总是有偏差。然而，通过良好的建模选择，它们仍然可以提供足够好的近似，从而在现实世界中解决实际问题。

一般来说，一个好的模型可能无法考虑每个变量或变量之间的每个交互。但通过在图结构中做出建模假设，我们可以生成极高效的推理技术，这些技术通常比简单的枚举推理方法在实际中更有用。
